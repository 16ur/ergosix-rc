---
interface Props {
  fillColor: string;
  position?: 'top' | 'bottom';
  animationDuration?: number;
  flip?: boolean;
  variant?: 1 | 2 | 3;
}

const { 
  fillColor, 
  position = 'bottom',
  animationDuration = 15,
  flip = false,
  variant = Math.floor(Math.random() * 3) + 1 as 1 | 2 | 3
} = Astro.props;

// Randomize duration slightly for variation
const randomDuration = animationDuration + (Math.random() * 4 - 2);
const randomDelay = Math.random() * 2;

// Different wave patterns for more variety
const wavePatterns = {
  1: {
    paths: [
      "M0,64L48,69.3C96,75,192,85,288,80C384,75,480,53,576,48C672,43,768,53,864,58.7C960,64,1056,64,1152,58.7C1248,53,1344,43,1392,37.3L1440,32L1440,120L1392,120C1344,120,1248,120,1152,120C1056,120,960,120,864,120C768,120,672,120,576,120C480,120,384,120,288,120C192,120,96,120,48,120L0,120Z",
      "M0,32L48,42.7C96,53,192,75,288,80C384,85,480,75,576,64C672,53,768,43,864,48C960,53,1056,75,1152,80C1248,85,1344,75,1392,69.3L1440,64L1440,120L1392,120C1344,120,1248,120,1152,120C1056,120,960,120,864,120C768,120,672,120,576,120C480,120,384,120,288,120C192,120,96,120,48,120L0,120Z",
      "M0,96L48,85.3C96,75,192,53,288,48C384,43,480,53,576,58.7C672,64,768,64,864,58.7C960,53,1056,43,1152,48C1248,53,1344,75,1392,85.3L1440,96L1440,120L1392,120C1344,120,1248,120,1152,120C1056,120,960,120,864,120C768,120,672,120,576,120C480,120,384,120,288,120C192,120,96,120,48,120L0,120Z",
      "M0,64L48,69.3C96,75,192,85,288,80C384,75,480,53,576,48C672,43,768,53,864,58.7C960,64,1056,64,1152,58.7C1248,53,1344,43,1392,37.3L1440,32L1440,120L1392,120C1344,120,1248,120,1152,120C1056,120,960,120,864,120C768,120,672,120,576,120C480,120,384,120,288,120C192,120,96,120,48,120L0,120Z"
    ]
  },
  2: {
    paths: [
      "M0,50L60,55C120,60,240,70,360,72C480,74,600,60,720,58C840,56,960,60,1080,65C1200,70,1320,50,1380,45L1440,40L1440,120L1380,120C1320,120,1200,120,1080,120C960,120,840,120,720,120C600,120,480,120,360,120C240,120,120,120,60,120L0,120Z",
      "M0,35L60,45C120,55,240,75,360,78C480,81,600,69,720,64C840,59,960,55,1080,58C1200,61,1320,65,1380,67L1440,70L1440,120L1380,120C1320,120,1200,120,1080,120C960,120,840,120,720,120C600,120,480,120,360,120C240,120,120,120,60,120L0,120Z",
      "M0,75L60,80C120,85,240,95,360,93C480,91,600,75,720,70C840,65,960,75,1080,78C1200,81,1320,75,1380,72L1440,70L1440,120L1380,120C1320,120,1200,120,1080,120C960,120,840,120,720,120C600,120,480,120,360,120C240,120,120,120,60,120L0,120Z",
      "M0,50L60,55C120,60,240,70,360,72C480,74,600,60,720,58C840,56,960,60,1080,65C1200,70,1320,50,1380,45L1440,40L1440,120L1380,120C1320,120,1200,120,1080,120C960,120,840,120,720,120C600,120,480,120,360,120C240,120,120,120,60,120L0,120Z"
    ]
  },
  3: {
    paths: [
      "M0,70L45,73C90,76,180,82,270,80C360,78,450,68,540,65C630,62,720,68,810,72C900,76,990,78,1080,75C1170,72,1260,60,1305,54L1350,48L1440,50L1440,120L1350,120C1260,120,1080,120,900,120C720,120,540,120,360,120C180,120,90,120,45,120L0,120Z",
      "M0,48L45,52C90,56,180,64,270,67C360,70,450,78,540,80C630,82,720,76,810,71C900,66,990,58,1080,60C1170,62,1260,72,1305,77L1350,82L1440,85L1440,120L1350,120C1260,120,1080,120,900,120C720,120,540,120,360,120C180,120,90,120,45,120L0,120Z",
      "M0,85L45,88C90,91,180,97,270,96C360,95,450,86,540,82C630,78,720,82,810,84C900,86,990,86,1080,82C1170,78,1260,66,1305,60L1350,54L1440,52L1440,120L1350,120C1260,120,1080,120,900,120C720,120,540,120,360,120C180,120,90,120,45,120L0,120Z",
      "M0,70L45,73C90,76,180,82,270,80C360,78,450,68,540,65C630,62,720,68,810,72C900,76,990,78,1080,75C1170,72,1260,60,1305,54L1350,48L1440,50L1440,120L1350,120C1260,120,1080,120,900,120C720,120,540,120,360,120C180,120,90,120,45,120L0,120Z"
    ]
  }
};

const selectedPattern = wavePatterns[variant];
---

<div class={`absolute ${position === 'bottom' ? 'bottom-0' : 'top-0'} left-0 w-full`} style={`margin-bottom: -1px; margin-top: 10px; transform: ${flip ? 'scaleY(-1)' : 'none'}; animation-delay: ${randomDelay}s;`}>
  <svg 
    viewBox="0 0 1440 120" 
    fill="none" 
    xmlns="http://www.w3.org/2000/svg" 
    class="w-full h-auto"
    preserveAspectRatio="none"
  >
    <path 
      d={selectedPattern.paths[0]}
      fill={fillColor}
    >
      <animate
        attributeName="d"
        dur={`${randomDuration}s`}
        repeatCount="indefinite"
        values={selectedPattern.paths.join(";")}
      />
    </path>
  </svg>
</div>

<style define:vars={{ fillColor }}>
  svg {
    display: block;
  }
</style>